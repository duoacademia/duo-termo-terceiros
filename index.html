<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DUO Academia — Autorização p/ Terceiros</title>
<style>
  :root{ --bg:#0f172a; --panel:#111827; --muted:#94a3b8; --fg:#e5e7eb; --line:#1f2937; --brand:#3b82f6; --ok:#22c55e; --danger:#ef4444; }
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",Arial;background:var(--bg);color:var(--fg)}
  .wrap{max-width:980px;margin:0 auto;padding:24px}
  header{display:flex;gap:16px;align-items:center;justify-content:space-between;padding:16px 0 24px;border-bottom:1px solid var(--line)}
  h1{font-size:20px;margin:0;font-weight:700}.badge{font-size:12px;color:var(--muted)}
  .grid{display:grid;grid-template-columns:1.15fr .85fr;gap:20px}@media(max-width:900px){.grid{grid-template-columns:1fr}}
  .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
  .card h2{font-size:16px;margin:0 0 12px}.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}.row-1{grid-template-columns:1fr}
  label{display:block;font-size:12px;color:var(--muted);margin:10px 0 6px}.req::after{content:" *";color:var(--danger);font-weight:700}
  input,select,textarea{width:100%;background:#0b1220;border:1px solid #1c2536;color:var(--fg);border-radius:10px;padding:12px;outline:none}
  input:focus,textarea:focus,select:focus{border-color:var(--brand);box-shadow:0 0 0 3px rgba(59,130,246,.25)}
  .help{font-size:12px;color:var(--muted);margin-top:4px}
  .buttons{display:flex;gap:10px;flex-wrap:wrap;margin-top:16px}
  .btn{appearance:none;border:1px solid #2a3448;background:#162136;color:#dbeafe;padding:8px 12px;border-radius:8px;cursor:pointer;font-size:14px}
  .btn.success{background:var(--ok);border-color:var(--ok);color:#001a07}.btn.danger{background:var(--danger);border-color:var(--danger);color:#fff}
  .terms{border:1px dashed #334155;border-radius:12px;padding:12px;background:#0b1220;max-height:220px;overflow:auto}
  .checkbox{display:flex;gap:10px;align-items:center;margin:12px 0}
  .checkbox input.ck{appearance:none;-webkit-appearance:none;width:22px;height:22px;border:2px solid #334155;border-radius:6px;background:#fff;display:inline-grid;place-content:center;cursor:pointer;outline:none}
  .checkbox input.ck::before{content:"";width:14px;height:14px;transform:scale(0);transition:120ms transform;background:var(--brand);border-radius:4px}
  .checkbox input.ck:checked::before{transform:scale(1)}

  .sig-wrap{background:#0b1220;border:1px solid #1c2536;border-radius:12px;padding:12px}
  .sig-wrap canvas{width:100%;height:220px;background:#fff;border-radius:8px;border:1px solid #334155;display:block;
                   touch-action:none;cursor:crosshair}

  .preview{position:sticky;top:24px}.hr{height:1px;background:#1f2937;border:0;margin:12px 0}
  footer{margin-top:20px;font-size:12px;color:var(--muted);text-align:center}
  .sheet{background:#fff;color:#111;width:794px;min-height:1123px;padding:28mm 20mm;border:1px solid #ddd;border-radius:6px;box-shadow:0 4px 30px rgba(0,0,0,.15)}
  .sheet h3{margin:0 0 8px}.sheet small{color:#555}.sheet .section{margin-top:14px}
  .sheet table{width:100%;border-collapse:collapse;font-size:13px}.sheet th,.sheet td{border:1px solid #ccc;padding:6px 8px;text-align:left}
  .sheet .sign-area{display:flex;gap:16px;align-items:flex-end;margin-top:24px}.sheet .sign-box{flex:1}
  .sheet .sign-img{max-width:100%;max-height:130px;border:none;background:transparent;display:block;margin:0 auto;object-fit:contain}
  .sheet .line{height:1px;background:#ccc;margin:6px 0}
  .sheet .brand{display:flex;align-items:center;gap:10px}.sheet .brand img.logo{height:38px;width:auto;display:block}

  /* Texto livre em MAIÚSCULO na digitação */
  input[type="text"], input:not([type]), textarea { text-transform: uppercase; }
  input[type="date"], input[type="number"] { text-transform: none; }
  #printArea .ans { text-transform: uppercase; }
  select:required:invalid{color:var(--muted)}

  /* >>> FIXE kerning/colagem de letras na área do PDF <<< */
  #printArea, #printArea *{
    font-family: Arial, Helvetica, sans-serif;
    font-kerning: none;
    letter-spacing: .2px;
    word-spacing: .4px;
    line-height: 1.25;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
  }
  #printArea table th, #printArea table td{ letter-spacing: .3px; }
  /* -------- Mobile: empilhar campos verticalmente -------- */
  @media (max-width: 760px){
    .grid{ grid-template-columns: 1fr; }
    .row{ grid-template-columns: 1fr !important; gap: 10px; }
    .buttons{ flex-direction: column; }
    .preview{ position: static; }               /* evita "sticky" no mobile */
    .sig-wrap canvas{ height: 180px; }          /* quadro menor para caber na tela */
    input, select, textarea{ font-size: 16px; } /* evita zoom automático no iOS */
  }

</style>
</head>
<body>
<div class="wrap">
  <header>
    <div>
      <h1>DUO Academia · Autorização para uso de cartão por terceiros</h1>
      <div class="badge">Preencha, aceite o termo e assine com o dedo (ou mouse). Depois gere o PDF.</div>
    </div>
    <div class="badge">v1.6.3</div>
  </header>

  <div class="grid">
    <div class="card">
      <h2>1) Dados do titular do cartão</h2>
      <div class="row">
        <div>
          <label for="titular_nome">Nome completo</label>
          <input id="titular_nome" placeholder="Ex.: JOÃO DA SILVA" type="text" />
        </div>
        <div>
          <label for="titular_cpf">CPF</label>
          <input id="titular_cpf" inputmode="numeric" maxlength="14" placeholder="000.000.000-00" type="text" />
          <div class="help">Validado somente ao gerar o PDF.</div>
        </div>
      </div>

      <h2 style="margin-top:18px">2) Dados do cartão</h2>
      <div class="row">
        <div>
          <label for="ultimos4">Quatro últimos dígitos</label>
          <input id="ultimos4" inputmode="numeric" maxlength="4" placeholder="1234" type="text" />
          <div class="help">Apenas 4 dígitos.</div>
        </div>
        <div>
          <label for="bandeira" class="req">Bandeira</label>
          <select id="bandeira" required aria-required="true">
            <option value="" selected disabled>Selecione…</option>
            <option>Visa</option><option>Mastercard</option><option>Elo</option>
            <option>Amex</option><option>Hipercard</option><option>Outros</option>
          </select>
        </div>
      </div>

      <h2 style="margin-top:18px">3) Dados do contratante</h2>
      <div class="row">
        <div>
          <label for="contratante_nome">Nome completo</label>
          <input id="contratante_nome" placeholder="Ex.: MARIA OLIVEIRA" type="text" />
        </div>
        <div>
          <label for="contratante_cpf">CPF</label>
          <input id="contratante_cpf" inputmode="numeric" maxlength="14" placeholder="000.000.000-00" type="text" />
        </div>
      </div>

      <h2 style="margin-top:18px">4) Termo de liberação</h2>
      <div class="terms" aria-readonly="true">
        <strong>DUO ACADEMIA</strong><br>
        Av. Simoa Gomes, 726 – Heliópolis · R. Dom José, 187 – Santo Antônio<br>
        (87) 9 9666-0021 | (87) 9 9934-1230 · coordenacaoduoacademia@gmail.com<br>
        <div class="hr"></div>
        <div class="title-tight" style="text-align:center;font-weight:700;margin:6px 0 12px">
          TERMO DE AUTORIZAÇÃO PARA USO DE CARTÃO DE CRÉDITO/DÉBITO POR TERCEIROS
        </div>
        <div class="section">
          <div style="font-weight:600;">[DADOS DO TITULAR DO CARTÃO]</div>
          NOME COMPLETO: <span class="mono" id="tt_pre_titular">____________________________</span><br>
          NÚMERO DO CPF: <span class="mono" id="tt_pre_cpf_titular">___.___.___-__</span>
        </div>
        <div class="section">
          <div style="font-weight:600;">[DADOS DO CARTÃO UTILIZADO]</div>
          QUATRO ÚLTIMOS DÍGITOS: <span class="mono" id="tt_pre_u4">____</span>
        </div>
        <div class="section">
          <div style="font-weight:600;">[DADOS DO CONTRATANTE DO PLANO]</div>
          NOME COMPLETO: <span class="mono" id="tt_pre_contratante">____________________________</span><br>
          NÚMERO DO CPF: <span class="mono" id="tt_pre_cpf_contratante">___.___.___-__</span>
        </div>
      </div>

      <label class="checkbox">
        <input id="aceite" class="ck" type="checkbox">
        <span>Declaro que li e concordo com o termo acima.</span>
      </label>

      <h2 style="margin-top:18px">5) Assinatura (rúbrica no touch)</h2>
      <div class="row">
        <div>
          <label>Data da assinatura</label>
          <div id="data_assinatura_view" style="font-weight:700">--/--/----</div>
          <!-- Campo oculto com o ISO yyyy-mm-dd que vai para a prévia/PDF -->
          <input id="data_assinatura" type="hidden" />
        </div>
      </div>

      <div class="sig-wrap" style="margin-top:10px">
        <div class="row-1 row">
          <div>
            <label for="signaturePad">Assine no quadro abaixo</label>
            <canvas id="signaturePad" width="900" height="350" aria-label="Área para assinatura com o dedo ou mouse"></canvas>
            <div class="buttons">
              <button class="btn" id="btnLimpar">Limpar</button>
            </div>
            <div class="help">Dica: gire o celular para paisagem se precisar de mais espaço.</div>
          </div>
        </div>
      </div>

      <div class="buttons">
        <button class="btn success" id="btnPDF">Gerar PDF</button>
        <button class="btn danger" id="btnReset">Resetar formulário</button>
      </div>
    </div>

    <div class="card preview">
      <h2>Pré-visualização do documento (PDF)</h2>
      <div class="help">A prévia atualiza automaticamente conforme você preenche.</div>
      <div id="printArea" class="sheet" aria-label="Área imprimível">
        <div style="display:flex;justify-content:space-between;align-items:flex-start">
          <div class="brand">
            <img id="sheet_logo" class="logo" alt="Logo DUO" />
            <div>
              <h3 style="margin:0 0 2px;">DUO ACADEMIA</h3>
              <small style="font-size:6px;line-height:.9;display:block;margin-top:0">
                Av. Simoa Gomes, 726 – Heliópolis · R. Dom José, 187 – Santo Antônio<br>
                (87) 9 9666-0021 | (87) 9 9934-1230 · coordenacaoduoacademia@gmail.com
              </small>
            </div>
          </div>
          <div style="text-align:right">
            <div style="font-size:12px;color:#444">Código: <span id="doc_id"></span></div>
            <div style="font-size:12px;color:#444">Data: <span id="doc_data"></span></div>
          </div>
        </div>
        <div class="line"></div>

        <div class="section">
          <table>
            <tr><th colspan="2">DADOS DO TITULAR DO CARTÃO</th></tr>
            <tr><td>Nome</td><td id="pv_titular_nome" class="ans"></td></tr>
            <tr><td>CPF</td><td id="pv_titular_cpf"></td></tr>
          </table>
        </div>

        <div class="section">
          <table>
            <tr><th colspan="2">DADOS DO CARTÃO UTILIZADO</th></tr>
            <tr><td>Últimos 4 dígitos</td><td id="pv_u4"></td></tr>
            <tr><td>Bandeira</td><td id="pv_bandeira" class="ans"></td></tr>
          </table>
        </div>

        <div class="section">
          <table>
            <tr><th colspan="2">DADOS DO CONTRATANTE DO PLANO</th></tr>
            <tr><td>Nome</td><td id="pv_contratante_nome" class="ans"></td></tr>
            <tr><td>CPF</td><td id="pv_contratante_cpf"></td></tr>
          </table>
        </div>

        <!-- PARÁGRAFO ÚNICO antes da rubrica -->
        <div class="section" id="paragrafo-unico">
          <table>
            <tr><th>PARÁGRAFO ÚNICO</th></tr>
            <tr>
              <td style="font-size:12px; line-height:1.35; text-align:justify">
                O TITULAR autoriza a CONTRATADA a utilizar o cartão de crédito e/ou débito dele
                para realizar a adesão de algum contrato, produto ou serviço para o CONTRATANTE,
                assumindo responsabilidade em caso de eventuais situações interpessoais entre
                TITULAR e CONTRATANTE.
              </td>
            </tr>
          </table>
        </div>

        <div class="section sign-area">
          <div class="sign-box">
            <div style="margin-bottom:6px">Assinante: <span id="pv_quem">Titular do Cartão</span></div>
            <img id="pv_assinatura" class="sign-img" alt="Assinatura" />
            <div class="line"></div>
            <div style="font-size:12px;color:#555">Assinatura (rúbrica)</div>
          </div>
        </div>
      </div>
      <footer>Dica: você também pode usar <strong>Imprimir &gt; Salvar como PDF</strong>.</footer>
    </div>
  </div>
</div>

<!-- libs -->
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

<script>
  const $ = (s)=>document.querySelector(s);
  const onlyDigits = v => (v||'').replace(/\D+/g,'');
  const U = s => (s || '').toLocaleUpperCase('pt-BR');
  const docId = () => new Date().toISOString().replace(/[-:TZ.]/g,'').slice(0,14);
  // Remove acentos e tudo que não for A-Z/0-9, e deixa MAIÚSCULO
  function slugUpper(s){
    return (s||'')
      .normalize('NFD').replace(/[\u0300-\u036f]/g,'')
      .toUpperCase()
      .replace(/[^A-Z0-9]+/g,'');
  }

  async function loadLogo(){
    const imgEl = $('#sheet_logo'); if(!imgEl) return;
    try{
      const resp = await fetch('logo.png', {cache:'no-store'});
      if(!resp.ok) throw 0;
      const blob = await resp.blob();
      const fr = new FileReader();
      fr.onload = ()=> imgEl.src = fr.result;
      fr.readAsDataURL(blob);
    }catch{ imgEl.src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8Xw8AAoMBm6o7oDkAAAAASUVORK5CYII='; }
  }

  // DATA: fixa hoje, sem perguntar
  function setTodayBR(){
    const d = new Date();
    const dd = String(d.getDate()).padStart(2,'0');
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const yy = d.getFullYear();
    const iso = `${yy}-${mm}-${dd}`;
    $('#data_assinatura').value = iso;         // hidden
    $('#data_assinatura_view').textContent = `${dd}/${mm}/${yy}`; // texto visível
    $('#doc_data').textContent = `${dd}/${mm}/${yy}`;             // cabeçalho da prévia
  }
  const formatDateBR = iso => { if(!iso) return ''; const [y,m,d]=iso.split('-'); return `${d}/${m}/${y}`; };

  // Máscaras
  const maskCPF = v => {
    v = onlyDigits(v).slice(0,11);
    return v.replace(/(\d{3})(\d)/,'$1.$2').replace(/(\d{3})(\d)/,'$1.$2').replace(/(\d{3})(\d{1,2})$/,'$1-$2');
  };
  $('#titular_cpf').addEventListener('input', e=> e.target.value = maskCPF(e.target.value));
  $('#contratante_cpf').addEventListener('input', e=> e.target.value = maskCPF(e.target.value));
  $('#ultimos4').addEventListener('input', e=> e.target.value = onlyDigits(e.target.value).slice(0,4));

  // Canvas assinatura — compatibilidade touch reforçada
  const canvas = $('#signaturePad');
  function resizeCanvasForHiDPI(){
    const ratio = Math.max(window.devicePixelRatio||1,1);
    const rect = canvas.getBoundingClientRect();
    canvas.width = rect.width * ratio;
    canvas.height = rect.height * ratio;
    const ctx = canvas.getContext('2d');
    ctx.setTransform(ratio,0,0,ratio,0,0);
    ctx.fillStyle = '#ffffff'; ctx.fillRect(0,0,rect.width,rect.height);
  }
  let signaturePad;

  function initSignature(){
    resizeCanvasForHiDPI();
    signaturePad = new window.SignaturePad(canvas, {
      backgroundColor: 'rgba(0,0,0,0)',
      penColor: '#111827',
      minWidth: 0.7,
      maxWidth: 2.2,
      throttle: 0
    });
    // Força o navegador a entregar os eventos de toque ao canvas
    const prevent = (e)=>{ e.preventDefault(); };
    canvas.addEventListener('touchstart', prevent, {passive:false});
    canvas.addEventListener('touchmove', prevent, {passive:false});
    canvas.addEventListener('touchend', prevent, {passive:false});
  }

  window.addEventListener('resize', ()=>{
    const data = signaturePad ? signaturePad.toData() : null;
    resizeCanvasForHiDPI();
    if(signaturePad){
      signaturePad.clear();
      if (data && data.length) signaturePad.fromData(data);
    }
  });

  $('#btnLimpar').addEventListener('click', (e)=>{ e.preventDefault(); if(signaturePad) signaturePad.clear(); renderPreview(); });

  // Recorte fino da assinatura (elimina “rebarbas”)
  function cropTransparent(dataURL, padding=6, threshold=1){
    return new Promise(resolve=>{
      const img = new Image();
      img.onload = ()=>{
        const w=img.width,h=img.height;
        const c=document.createElement('canvas'); c.width=w; c.height=h;
        const ctx=c.getContext('2d',{willReadFrequently:true}); ctx.drawImage(img,0,0);
        const dt=ctx.getImageData(0,0,w,h).data;
        let top=h,left=w,right=0,bottom=0;
        for(let y=0;y<h;y++) for(let x=0;x<w;x++){
          const a=dt[(y*w+x)*4+3]; if(a>threshold){ if(x<left)left=x; if(x>right)right=x; if(y<top)top=y; if(y>bottom)bottom=y; }
        }
        if(right<left||bottom<top){ resolve(''); return; }
        left=Math.max(0,left-padding); top=Math.max(0,top-padding);
        right=Math.min(w-1,right+padding); bottom=Math.min(h-1,bottom+padding);
        const cw=right-left+1,ch=bottom-top+1;
        const c2=document.createElement('canvas'); c2.width=cw; c2.height=ch;
        c2.getContext('2d').drawImage(c,left,top,cw,ch,0,0,cw,ch);
        resolve(c2.toDataURL('image/png'));
      };
      img.src = dataURL;
    });
  }

  function getValues(){
    return {
      titular_nome: $('#titular_nome').value.trim(),
      titular_cpf: $('#titular_cpf').value.trim(),
      ultimos4: onlyDigits($('#ultimos4').value).slice(0,4),
      bandeira: $('#bandeira').value.trim(),
      contratante_nome: $('#contratante_nome').value.trim(),
      contratante_cpf: $('#contratante_cpf').value.trim(),
      aceite: $('#aceite').checked,
      data: $('#data_assinatura').value // hidden
    };
  }

  async function renderPreview(){
    const v = getValues();
    $('#doc_data').textContent = formatDateBR(v.data);
    $('#pv_titular_nome').textContent = U(v.titular_nome);
    $('#pv_titular_cpf').textContent = v.titular_cpf;
    $('#pv_u4').textContent = v.ultimos4;
    $('#pv_bandeira').textContent = U(v.bandeira || '—');
    $('#pv_contratante_nome').textContent = U(v.contratante_nome);
    $('#pv_contratante_cpf').textContent = v.contratante_cpf;
    $('#tt_pre_titular').textContent = U(v.titular_nome) || '____________________________';
    $('#tt_pre_cpf_titular').textContent = v.titular_cpf || '___.___.___-__';
    $('#tt_pre_u4').textContent = v.ultimos4 || '____';
    $('#tt_pre_contratante').textContent = U(v.contratante_nome) || '____________________________';
    $('#tt_pre_cpf_contratante').textContent = v.contratante_cpf || '___.___.___-__';

    if (signaturePad && !signaturePad.isEmpty()) {
      const png = await cropTransparent(signaturePad.toDataURL('image/png'), 6);
      $('#pv_assinatura').src = png;
    } else {
      $('#pv_assinatura').src = '';
    }
  }

  function isValidCPF(cpf){
    cpf = onlyDigits(cpf);
    if (cpf.length !== 11) return false;
    if (/^(\d)\1{10}$/.test(cpf)) return false;
    let s=0,r; for(let i=1;i<=9;i++) s+=parseInt(cpf.substring(i-1,i))*(11-i);
    r=(s*10)%11; if(r===10||r===11) r=0; if(r!==parseInt(cpf.substring(9,10))) return false;
    s=0; for(let i=1;i<=10;i++) s+=parseInt(cpf.substring(i-1,i))*(12-i);
    r=(s*10)%11; if(r===10||r===11) r=0; return r===parseInt(cpf.substring(10,11));
  }

  function validateForPDF(v){
    if (!v.titular_nome) return 'Informe o nome completo do TITULAR.';
    if (!v.contratante_nome) return 'Informe o nome completo do CONTRATANTE.';
    if (!isValidCPF(v.titular_cpf)) return 'CPF do TITULAR inválido.';
    if (!isValidCPF(v.contratante_cpf)) return 'CPF do CONTRATANTE inválido.';
    if (!v.ultimos4 || v.ultimos4.length !== 4) return 'Informe os 4 últimos dígitos do cartão.';
    if (!v.bandeira) return 'Informe a bandeira do cartão.';
    if (!v.aceite) return 'Você precisa aceitar o termo.';
    if (!signaturePad || signaturePad.isEmpty()) return 'Assine no quadro antes de gerar o PDF.';
    return null;
  }

  async function generatePDF(){
    const v = getValues();
    const err = validateForPDF(v);
    if (err){ alert(err); return; }
    $('#doc_id').textContent = docId();
    await renderPreview();
    const area = document.getElementById('printArea');
    const canvasImg = await html2canvas(area, { scale: 2, useCORS: true });
    const imgData = canvasImg.toDataURL('image/png');
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF('p','mm','a4');
    const pageWidth = pdf.internal.pageSize.getWidth();
    const w = pageWidth - 20, h = (canvasImg.height * w) / canvasImg.width;
    pdf.addImage(imgData, 'PNG', 10, 10, w, h, undefined, 'FAST');
    // Monta nome: TERMOCARTAO_<NOME_CONTRATANTE>_<DDMMAAAA>
    const [y,m,d] = ($('#data_assinatura').value || '').split('-');
    const hoje = new Date();
    const dd = (d || String(hoje.getDate()).padStart(2,'0'));
    const mm = (m || String(hoje.getMonth()+1).padStart(2,'0'));
    const yy = (y || String(hoje.getFullYear()));
    const dataStr = `${dd}${mm}${yy}`;
    const nome = slugUpper($('#contratante_nome').value);
    const filename = `TERMOCARTAO_${nome}_${dataStr}.pdf`;
    pdf.save(filename);
  }

  // Listeners
  ['titular_nome','titular_cpf','ultimos4','bandeira','contratante_nome','contratante_cpf','aceite']
    .forEach(id => { const el = document.getElementById(id); if(el){ el.addEventListener('input', renderPreview); el.addEventListener('change', renderPreview); }});
  document.getElementById('btnPDF').addEventListener('click', e=>{ e.preventDefault(); generatePDF(); });
  document.getElementById('btnReset').addEventListener('click', e=>{ e.preventDefault(); if(confirm('Limpar todos os campos?')) location.reload(); });

  // Boot: garanto ordem segura p/ layout + touch
  (async function boot(){
    await loadLogo();
    setTodayBR();
    requestAnimationFrame(()=>{ initSignature(); renderPreview(); });
  })();
</script>
</body>
</html>
